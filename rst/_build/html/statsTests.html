

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hypothesis tests &mdash; Introduction to Statistics 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Introduction to Statistics 1.0 documentation" href="index.html" />
    <link rel="next" title="Distribution of a Sample Mean" href="statsContinuous.html" />
    <link rel="prev" title="Characterizing a Distribution" href="statsDistributions.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="statsContinuous.html" title="Distribution of a Sample Mean"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="statsDistributions.html" title="Characterizing a Distribution"
             accesskey="P">previous</a> |</li>
        <li><a href="StatsFH.html">Introduction to Statistics 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <img alt="_images/title_tests.png" src="_images/title_tests.png" style="height: 100px;" />
<div class="section" id="hypothesis-tests">
<h1>Hypothesis tests<a class="headerlink" href="#hypothesis-tests" title="Permalink to this headline">¶</a></h1>
<p>[sec:hypotheses] Statistical evaluations are based on the initially
often counterintuitive procedure of <em>hypothesis tests</em>. A hypothesis
test is a standard format for assessing statistical evidence. It is
ubiquitous in scientific literature, most often appearing in the form of
statements of <em>statistical significance</em> and quotations like
<span class="math">\(&quot;p&lt;0.01&quot;\)</span> that pepper scientific journals. Thereby you proceed as
follows: you</p>
<ul class="simple">
<li>state your hypothesis.</li>
<li>decide which value you want to test your hypothesis on.</li>
<li>calculate the <em>probability p</em> that you find the given value, assuming
that your hypothesis is true</li>
</ul>
<p>The first hypothesis is referred to as <em>null-hypothesis</em>, since we
assume that there is <em>null</em> difference between the hypothesis and the
result. The found probability for a specific target value is the
<em>p-value</em> that you typically find in the literature. If <span class="math">\(p&lt;0.05\)</span>,
the difference between your sample and the value that you check is
<em>significant</em>. If <span class="math">\(p&lt;0.001\)</span>, we speak of a <em>highly significant</em>
difference.</p>
<p>An example for a <em>null hypothesis</em>: &#8220;We assume that our population has a
mean value of 7.&#8221;</p>
<div class="section" id="types-of-error">
<h2>Types of Error<a class="headerlink" href="#types-of-error" title="Permalink to this headline">¶</a></h2>
<p>In hypothesis testing, two types of errors can occur:</p>
<div class="section" id="type-i-errors">
<h3>Type I errors<a class="headerlink" href="#type-i-errors" title="Permalink to this headline">¶</a></h3>
<p>These are errors, where you get a significant result despite the fact
that the hypothesis is true. The likelihood of a Type I error is
commonly indicated with <span class="math">\(\alpha\)</span>, and <em>is set before you start the
data analysis</em>.</p>
<p>For example, assume that the population of young Austrian adults has a
mean IQ of 105 (i.e. we are smarter than the rest) and a standard
deviation of 15. We now want to check if the average FH student in Linz
has the same IQ as the average Austrian, and we select 20 students. We
set <span class="math">\(\alpha=0.05\)</span>, i.e. we set our significance level to 95%. Let
us now assume that the average student has in fact the same IQ as the
average Austrian. If we repeat our study 20 times, we will find one of
those 20 times that our sample mean is significantly different from the
Austrian average IQ. Such a finding would be a false result, despite the
fact that our assumption is correct, and would constitute a <em>type I
error</em>.</p>
</div>
<div class="section" id="type-ii-errors-and-test-power">
<h3>Type II errors and Test Power<a class="headerlink" href="#type-ii-errors-and-test-power" title="Permalink to this headline">¶</a></h3>
<p>If we want to answer the question &#8220;How much chance do we have to reject
the null hypothesis when the alternative is in fact true?&#8221; Or in other
words, &#8220;What’s the probability of detecting a real effect?&#8221; we are faced
with a different problem. To answer these questions, we need an
<em>alternative hypothesis</em>.</p>
<p>For the example given above, an <em>alternative hypothesis</em> could be: &#8220;We
assume that our population has a mean value of 6.&#8221;</p>
<p>A <em>Type II error</em> is an error, where you do <em>not</em> get a significant
result, despite the fact that the null-hypothesis is false. The
probability for this type of error is commonly indicated with
<span class="math">\(\beta\)</span>. The <em>power</em> of a statistical test is defined as
<span class="math">\((1-\beta)*100\)</span>, and is the chance of correctly accepting the
alternate hypothesis. Figure [fig:power1] shows the meaning of the
<em>power</em> of a statistical test. Note that for finding the power of a
test, you need an alternative hypothesis.</p>
</div>
</div>
<div class="section" id="sample-size">
<h2>Sample Size<a class="headerlink" href="#sample-size" title="Permalink to this headline">¶</a></h2>
<p>The power of a statistical test depends on four factors:</p>
<ol class="arabic simple">
<li><span class="math">\(\alpha\)</span>, the probability for Type I errors</li>
<li><span class="math">\(\beta\)</span>, the probability for Type II errors (
<span class="math">\(\Rightarrow\)</span> power of the test)</li>
<li><span class="math">\(d\)</span>, the magnitude of the investigated effect relative to
<span class="math">\(\sigma\)</span>, the standard deviation of the sample</li>
<li><span class="math">\(n\)</span>, the sample size</li>
</ol>
<p>Only 3 of these 4 parameters can be chosen, the <span class="math">\(4^{th}\)</span> is then
automatically fixed.</p>
<p>The size of the difference, <span class="math">\(d\)</span>, between mean treatment outcomes
that will answer the clinical question being posed is often called
<em>clinical significance</em> or <em>clinical relevance</em>.</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/power1.png"><img alt="image21" src="_images/power1.png" style="width: 400.0px; height: 392.0px;" /></a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/power2.png"><img alt="image22" src="_images/power2.png" style="width: 400.0px; height: 341.0px;" /></a></div>
</div>
<div class="section" id="examples-for-some-special-cases">
<h3>Examples for some special cases<a class="headerlink" href="#examples-for-some-special-cases" title="Permalink to this headline">¶</a></h3>
<p>For a test on one mean, this leads to a <em>minimum sample number</em> of</p>
<div class="math">
\[n = \frac{{{{({z_{1 - \alpha /2}} + {z_{1 - \beta }})}^2}{\sigma ^2}}}{{{d^2}}}\]</div>
<p>Here z is the standardized normal variable (see also chapter
[sec:normalDistribution])</p>
<div class="math">
\[z = \frac{x-\mu}{\sigma} .\]</div>
<p>For finding a difference between two normally distributed means, the
minimum number of samples we need in each group is</p>
<div class="math">
\[{n_1} = {n_2} = \frac{{({z_{1 - \alpha /2}} + {z_{1 - \beta }})}^2(\sigma _1^2 + \sigma _2^2)}{d^2} .\]</div>
</div>
<div class="section" id="programs-samplesize">
<h3>Programs: SampleSize<a class="headerlink" href="#programs-samplesize" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;Calculate the sample size for experiments, for normally distributed groups.</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Author : Thomas Haslwanter</span>
<span class="sd">Date : Feb 2013</span>
<span class="sd">Ver : 1.0</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="nb">round</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">sampleSize_oneGroup</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Sample size for a single group.&#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">+</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;In order to detect a change of {0} in a group with an SD of {1},&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;with significance {0} and test-power {1}, you need at least {2:d} subjects.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">sampleSize_twoGroups</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">sigma1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma2</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Sample size for two groups.&#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">+</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sigma1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sigma2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;In order to detect a change of {0} between groups with an SD of {1} and {2},&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;with significance {0} and test-power {1}, you need in each group at least {2:d} subjects.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">sampleSize_oneGroup</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">sampleSize_twoGroups</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">sigma1</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">sigma2</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sensitivity-and-specificity">
<h1>Sensitivity and Specificity<a class="headerlink" href="#sensitivity-and-specificity" title="Permalink to this headline">¶</a></h1>
<p>Some of the more confusing terms in statistical analysis are
<em>sensitivity</em> and <em>specificity</em> . A related topic are <em>positive
predictive value (PPV)</em> and <em>negative predictive value (NPV)</em> . The
following diagram shows how the four are related:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/Sensitivity_Specificity_Diagram.png"><img alt="image23" src="_images/Sensitivity_Specificity_Diagram.png" style="width: 458.0px; height: 230.5px;" /></a></div>
</div>
<ul class="simple">
<li><strong>Sensitivity</strong> = proportion of positives that are correctly
identified by a test = probability of a positive test, given the
patient is ill.</li>
<li><strong>Specificity</strong> = proportion of negatives that are correctly
identified by a test = probability of a negative test, given that
patient is well.</li>
<li><strong>Positive predictive value</strong> is the proportion of patients with
positive test results who are correctly diagnosed.</li>
<li><strong>Negative predictive value</strong> is the proportion of patients with
negative test results who are correctly diagnosed.</li>
</ul>
<p>While sensitivity and specificity are independent of prevalence, they do
not tell us what portion of patients with abnormal test results are
truly abnormal. This information is provided by the positive/negative
predictive value. However, as Fig. [fig:prevalence] indicates, these
values are affected by the <em>prevalence</em> of the disease. In other words,
we need to know the prevalence of the disease as well as the PPV/NPV of
a test to provide a sensible interpretation of the test results.</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/Sensitivity_Specificity.png"><img alt="image24" src="_images/Sensitivity_Specificity.png" style="width: 900.0px; height: 434.25px;" /></a></div>
</div>
<p>The Figure gives a worked example:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="_images/Sensitivity_Specificity_Example.png"><img alt="image25" src="_images/Sensitivity_Specificity_Example.png" style="width: 667.5px; height: 420.0px;" /></a></div>
</div>
<ul class="simple">
<li>False positive rate (<span class="math">\(\alpha\)</span>) = type I error =
<span class="math">\(1-specificity\)</span> = <span class="math">\(\frac{FP}{FP + TN}\)</span> =
<span class="math">\(\frac{180}{180+1820}\)</span> = 9%</li>
<li>False negative rate (<span class="math">\(\beta\)</span>) = type II error =
<span class="math">\(1−sensitivity\)</span> = <span class="math">\(\frac{FN}{TP + FN}\)</span> =
<span class="math">\(\frac{10}{20+10}\)</span> = 33%</li>
<li>Power = sensitivity = <span class="math">\(1−\beta\)</span></li>
<li>Likelihood ratio positive = <span class="math">\(\frac{sensitivity}{1−specificity}\)</span>
= <span class="math">\(\frac{66.67\%}{1−91\%}\)</span> = 7.4</li>
<li>Likelihood ratio negative = <span class="math">\(\frac{1−sensitivity}{specificity}\)</span>
= <span class="math">\(\frac{1−66.67\%}{91\%}\)</span> = 0.37</li>
</ul>
<p>Hence with large numbers of false positives and few false negatives, a
positive FOB screen test is in itself poor at confirming cancer (PPV =
10%) and further investigations must be undertaken; it did, however,
correctly identify 66.7% of all cancers (the sensitivity). However as a
screening test, a negative result is very good at reassuring that a
patient does not have cancer (NPV = 99.5%) and at this initial screen
correctly identifies 91% of those who do not have cancer (the
specificity).</p>
</div>
<div class="section" id="large-sample-tests">
<h1>Large Sample Tests<a class="headerlink" href="#large-sample-tests" title="Permalink to this headline">¶</a></h1>
<p>Here I give an overview of the most common statistical tests for
different combinations of data. This overview is taken from .</p>
<table class="docutils citation" frame="void" id="table-tests" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[table:tests]</td><td></td></tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="StatsFH.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Hypothesis tests</a><ul>
<li><a class="reference internal" href="#types-of-error">Types of Error</a><ul>
<li><a class="reference internal" href="#type-i-errors">Type I errors</a></li>
<li><a class="reference internal" href="#type-ii-errors-and-test-power">Type II errors and Test Power</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sample-size">Sample Size</a><ul>
<li><a class="reference internal" href="#examples-for-some-special-cases">Examples for some special cases</a></li>
<li><a class="reference internal" href="#programs-samplesize">Programs: SampleSize</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sensitivity-and-specificity">Sensitivity and Specificity</a></li>
<li><a class="reference internal" href="#large-sample-tests">Large Sample Tests</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="statsDistributions.html"
                        title="previous chapter">Characterizing a Distribution</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="statsContinuous.html"
                        title="next chapter">Distribution of a Sample Mean</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/statsTests.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="statsContinuous.html" title="Distribution of a Sample Mean"
             >next</a> |</li>
        <li class="right" >
          <a href="statsDistributions.html" title="Characterizing a Distribution"
             >previous</a> |</li>
        <li><a href="StatsFH.html">Introduction to Statistics 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright March 2013, Thomas Haslwanter.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>